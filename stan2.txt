#include<bits/stdc++.h>#include<iostream>#include<fstream>#include<vector>#include<string>#include<cstring>#include<sstream>#include<set>usingnamespacestd;char*fileName;ifstreamiFile;ofstreamoFile;vector<string>dataType_list,methods_list,variables_list;map<string,vector<string>>methodsAndTheirVariables;map<string,vector<string>>::iteratorfinalMapIT;map<string,int>variablesHolder,methodsHolder;map<string,int>::iteratorit;map<int,string>reverseMethods;map<int,string>::iteratorrev;map<string,int>methodAndLine,variableAndLine;//map<string,int>::iteratornameLineIT;voidline_Number_And_Char_Count(int&total_lines,int&total_chars);voidclearEverything();voidWords_Keys_And_Loop_Count(int&total_words,int&total_keywords,int&total_loops);voidMethods_VAriebles_Count(int&total_variebles,int&total_methods);voidClear_Method_and_Variables_Name();voidprinting_line_char_word_keyword(inttotal_lines,inttotal_chars,inttotal_words,inttotal_keywords);voidprinting_loop(inttotal_loops);voidShow_Changed_Source_Code();voidVariable_Name_Search();voidMethod_Name_Search();voidTaking_User_Input_For_Changing_A_Name();boolCheck_A_Valid_Name_Request(stringreplaceBy,vector<string>locaal);boolGlobal_Struct_Union_Variable_Identify(stringword);voidCheck_For_False_Method_And_Variable(string&word);voidMake_Relationship_Variable_and_Method();voidShow_Methods_And_Their_Children_Variables();voidchange_method_name(stringmethodName,stringreplaceBy);boolcheckVariableInRelationshipTree();voidChange_Variable_Name(stringmethodName,stringvarName,stringreplaceBy);voidline_Number_And_Char_Count(int&total_lines,int&total_chars){iFile.open(fileName);charch;while(iFile.get(ch)){total_chars++;if(ch=='\n')total_lines++;}iFile.close();}voidShow_Changed_Source_Code(){iFile.open(fileName);oFile.open("source_temp.txt");charch;while(iFile.get(ch)){oFile<<ch;}oFile.close();iFile.close();}voidWords_Keys_And_Loop_Count(int&total_words,int&total_keywords,int&total_loops){oFile.open("source_temp.txt");iFile.open(fileName);charch;stringword;while(iFile.get(ch)){if((ch>=65andch<=90)or(ch>=97andch<=122)or(ch>=48andch<=57)){oFile<<ch;}elseif(ch=='\n')oFile<<endl;elseoFile<<"";}iFile.close();oFile.close();dataType_list.push_back("void");dataType_list.push_back("int");dataType_list.push_back("char");dataType_list.push_back("float");dataType_list.push_back("double");dataType_list.push_back("short");dataType_list.push_back("long");dataType_list.push_back("signed");dataType_list.push_back("unsigned");intforLoop=0,doLoop=0,whileLoop=0;boolflag=false,yes1=false,yes2=false;stringfalse_dataType;iFile.open("source_temp.txt");boolloopFound_NowVariableHasToFind=false;while(iFile>>word){total_words++;if(loopFound_NowVariableHasToFind){if(!(word[0]>='0'andword[0]<='9')){//loop_variables.insert(word);loopFound_NowVariableHasToFind=false;}}for(inti=0;i<32;i++){if(word==keywords_list[i]){total_keywords++;if(word=="while"){whileLoop++;loopFound_NowVariableHasToFind=true;}elseif(word=="for"){forLoop++;loopFound_NowVariableHasToFind=true;}elseif(word=="do"){doLoop++;}break;}}if(flag){booltemp=true;for(inti=0;i<dataType_list.size();i++){if(word==dataType_list[i]){temp=false;break;}}if(temp){dataType_list.push_back(word);flag=false;}}if(word=="typedef"orword=="struct"orword=="union"){flag=true;}}iFile.close();total_loops=forLoop+doLoop+(whileLoop-doLoop);}voidCheck_For_False_Method_And_Variable(string&word){intpos1=-1,pos2=-1;for(inti=0;i<word.length();i++){if(word[i]=='"'){pos1=i;for(intk=pos1+1;k<word.length();k++){if(word[k]=='"'){pos2=k;break;}}if(pos2==-1)return;//cout<<pos1<<""<<pos2<<endl;word.erase(word.begin()+pos1+1,word.end()-(word.length()-pos2));//cout<<word<<endl;return;}}}boolGlobal_Struct_Union_Variable_Identify(stringword,intnumber){//cout<<"yeahbro\n";for(inti=0;i<word.length();i++){if(word[i]=='')continue;if(word[i]!='}')returnfalse;elsebreak;}for(inti=0;i<word.length();i++){if(!((word[i]>='A'andword[i]<='Z')or(word[i]>='a'andword[i]<='z')or(word[i]>=48andword[i]<=57))){word[i]='';}}istringstreamiss(word);stringtemp;while(iss>>temp){if(temp[0]>=48andtemp[0]<=57)continue;variables_list.push_back(temp);variableAndLine[temp]=number;}returntrue;}voidMethods_VAriebles_Count(int&total_variebles,int&total_methods){iFile.open(fileName);stringword;boolbreakLine=false;boolflagForStructAndUnion=false;intlineNumberHere=0;while(getline(iFile,word)){lineNumberHere++;Check_For_False_Method_And_Variable(word);if(flagForStructAndUnion){if(Global_Struct_Union_Variable_Identify(word,lineNumberHere)){flagForStructAndUnion=false;}continue;}if(breakLine)breakLine=false;stringword2=word,first_Word;istringstreamiss(word2);iss>>first_Word;if(first_Word=="typedef"){continue;}if(first_Word=="struct"orfirst_Word=="union"){flagForStructAndUnion=true;}for(inti=0;i<dataType_list.size();i++){if(breakLine)break;stringdataType=dataType_list[i]+"";boolflag=false;intpos=0;for(intk=0;k<word.length();k++){if(breakLine)break;if(word.length()<dataType.length()+2)break;//ifif(!flag){stringtemp=word.substr(k,dataType.length());if(temp==dataType)//parametercheckandfalsevariable/methodcheck{boolifAlreadyMethodExistsInThisLine=false;for(intp=k;p>=0;p--){if(word[p]=='('orword[p]=='"'){ifAlreadyMethodExistsInThisLine=true;break;}}if(!ifAlreadyMethodExistsInThisLine){flag=true;k+=dataType.length();pos=k;k++;}}}if(flag){if(word[k]=='('){total_methods++;flag=false;methods_list.push_back(word.substr(pos,k-pos));methodAndLine[word.substr(pos,k-pos)]=lineNumberHere;pos=0;breakLine=true;break;}elseif(word[k]==';'orword[k]==','){total_variebles++;stringdblVar=word.substr(pos,k-pos);while(true){boolyeah=false;for(intz=0;z<variables_list.size();z++){if(dblVar==variables_list[z]){dblVar+=".";yeah=true;break;}}if(yeah==false)break;}variables_list.push_back(dblVar);//if(dblVar)variables_list[variables_list.size()-1]=lastVal+".";variableAndLine[variables_list[variables_list.size()-1]]=lineNumberHere;pos=k+1;if(word[k]==';')flag=false;}}}if(breakLine)break;}}iFile.close();}voidClear_Method_and_Variables_Name(){for(inti=0;i<variables_list.size();i++){intpos1=0,pos2=0;intline1=variableAndLine[variables_list[i]];//cout<<variables_list[i]<<""<<line1<<endl;for(intk=0;k<variables_list[i].size();k++){charch=variables_list[i][k];if((ch>=65andch<=90)or(ch>=97andch<=122)orch=='_'){pos1=k;break;}}for(intk=pos1;k<variables_list[i].size();k++){charch=variables_list[i][k];if(!((ch>=65andch<=90)orch=='.'or(ch>=97andch<=122)orch=='_'or(ch>=48andch<=57))){pos2=k;break;}}if(pos2==0){variables_list[i]=variables_list[i].substr(pos1,variables_list[i].length()-pos1);}else{variables_list[i]=variables_list[i].substr(pos1,pos2-pos1);}boolquotemark=false;for(intz=0;z<variables_list[i].size();z++){if(variables_list[i][z]=='"'orvariables_list[i][z]==39){quotemark=true;break;}}if(quotemark)continue;variablesHolder[variables_list[i]]=line1;for(intk=0;k<dataType_list.size();k++){if(variables_list[i]==dataType_list[k]){variables_list.erase(variables_list.begin()+i,variables_list.end()-(variables_list.size()-1-i));i--;}}for(intk=0;k<dataType_list.size();k++){for(it=variablesHolder.begin();it!=variablesHolder.end();it++){if(dataType_list[k]==it->first){variablesHolder.erase(it);break;}}}}for(inti=0;i<methods_list.size();i++){intpos=0,line2=methodAndLine[methods_list[i]];//cout<<methods_list[i]<<""<<line<<endl;for(intk=0;k<methods_list[i].size();k++){charch=methods_list[i][k];if((ch>=65andch<=90)or(ch>=97andch<=122)orch=='_'){pos=k;break;}}methods_list[i]=methods_list[i].substr(pos,methods_list[i].length()-pos);methodsHolder[methods_list[i]]=line2;}}voidMake_Relationship_Variable_and_Method(){map<string,bool>visibility;map<string,bool>::iteratorvis;for(it=variablesHolder.begin();it!=variablesHolder.end();it++){visibility[it->first]=false;}for(it=methodsHolder.begin();it!=methodsHolder.end();it++){reverseMethods[it->second]=it->first;}rev=reverseMethods.begin();intstart=rev->first;vector<string>tempVec;for(it=variablesHolder.begin();it!=variablesHolder.end();it++){if(it->second<start){stringitFirst=it->first;intdotCount=0;for(intz=itFirst.length()-1;z>=0;z--){if(itFirst[z]=='.')dotCount++;elsebreak;}itFirst=itFirst.substr(0,itFirst.length()-dotCount);tempVec.push_back(itFirst);visibility[it->first]=true;}}methodsAndTheirVariables["Global"]=tempVec;tempVec.clear();for(rev=reverseMethods.begin();rev!=reverseMethods.end();rev++){//if(rev->second=="main")break;erev++;if(rev==reverseMethods.end())break;rev--;start=rev->first;rev++;intlast=rev->first;rev--;tempVec.clear();for(it=variablesHolder.begin();it!=variablesHolder.end();it++){if(it->second>startandit->second<last){stringitFirst=it->first;intdotCount=0;for(intz=itFirst.length()-1;z>=0;z--){if(itFirst[z]=='.')dotCount++;elsebreak;}itFirst=itFirst.substr(0,itFirst.length()-dotCount);tempVec.push_back(itFirst);visibility[it->first]=true;}}methodsAndTheirVariables[rev->second]=tempVec;}tempVec.clear();for(vis=visibility.begin();vis!=visibility.end();vis++){if(vis->second==false){stringitFirst=vis->first;intdotCount=0;for(intz=itFirst.length()-1;z>=0;z--){if(itFirst[z]=='.')dotCount++;elsebreak;}itFirst=itFirst.substr(0,itFirst.length()-dotCount);tempVec.push_back(itFirst);visibility[vis->first]=true;}}rev=reverseMethods.end();rev--;methodsAndTheirVariables[rev->second]=tempVec;}voidprinting_line_char_word_keyword(inttotal_lines,inttotal_chars,inttotal_words,inttotal_keywords){oFile.open("output.txt");oFile<<"totallinenumbers="<<total_lines<<endl;oFile<<"totalwordsnumbers="<<total_words<<endl;oFile<<"totalcharnumbers="<<total_chars<<endl;oFile<<"totalkeywordsnumbers="<<total_keywords<<endl;}voidprinting_loop(inttotal_loops){oFile<<"totalloopnumber="<<total_loops;oFile<<endl<<endl<<endl;oFile.close();}boolCheck_A_Valid_Name_Request(stringreplaceBy,vector<string>locaal){for(inti=0;i<locaal.size();i++){if(locaal[i]==replaceBy){returntrue;}}returnfalse;}voidShow_Methods_And_Their_Children_Variables(){intcnt=1;for(finalMapIT=methodsAndTheirVariables.begin();finalMapIT!=methodsAndTheirVariables.end();finalMapIT++){cout<<cnt<<":"<<finalMapIT->first<<endl;intcnt2=1;for(intk=0;k<(finalMapIT->second).size();k++){cout<<"\t"<<cnt<<"."<<cnt2<<""<<(finalMapIT->second)[k]<<endl;cnt2++;}cout<<endl;cnt++;}}boolcheckVariableInRelationshipTree(stringname){for(finalMapIT=methodsAndTheirVariables.begin();finalMapIT!=methodsAndTheirVariables.end();finalMapIT++){for(intk=0;k<(finalMapIT->second).size();k++){if((finalMapIT->second)[k]==name){returntrue;}}}returnfalse;}voidchange_method_name(stringmethodName,stringreplaceBy){ofstreamoFileHere;iFile.open(fileName);oFileHere.open("sudo.c");stringword;while(getline(iFile,word)){for(inti=0;i<=word.length()-methodName.length();i++){if(word.length()<methodName.length()+3)break;stringmatch=word.substr(i,methodName.length());match;if(match==methodName){//cout<<match<<endl;//cout<<"yesssssssssssssssssssss";stringone,two,three;one=two=three="";one=word.substr(0,i);two=replaceBy;three=word.substr(i+methodName.length(),word.length()-(i+methodName.length()));word=one+two+three;break;}}oFileHere<<word<<endl;}iFile.close();oFileHere.close();iFile.open("sudo.c");oFileHere.open(fileName);charch;while(iFile.get(ch)){oFileHere<<ch;}iFile.close();oFileHere.close();}voidChange_Variable_Name(stringmethodName,stringvarName,stringreplaceBy){/*intfirst,last;for(rev=reverseMethods.begin();rev!=reverseMethods.end();rev++){cout<<rev->first<<""<<rev->second<<endl;}*/vector<int>vec;for(rev=reverseMethods.begin();rev!=reverseMethods.end();rev++){vec.push_back(rev->first);}vec.push_back(0);vec.push_back(12345678);sort(vec.begin(),vec.end());intfirst,last;for(it=methodsHolder.begin();it!=methodsHolder.end();it++){if(it->first==methodName){first=it->second;break;}}for(intk=0;k<vec.size();k++){if(vec[k]==first){last=vec[k+1];break;}}//cout<<first<<""<<last<<endl;ofstreamoFileHere;iFile.open(fileName);oFileHere.open("sudo.c");stringword;intc=0;while(getline(iFile,word)){c++;if(c<firstorc>last){oFileHere<<word<<endl;continue;}for(inti=0;i<word.length();i++){if(word.length()<=varName.length())break;stringtemp=word.substr(i,varName.length());if(temp==varName){//cout<<"cc:"<<c<<endl;intlen=varName.length();if((word[i-1]>=97andword[i-1]<=122)or(word[i-1]>=65andword[i-1]<=90)or(word[i-1]>=48andword[i-1]<=57)orword[i-1]=='_'){continue;}elseif((word[i+len]>=97andword[i+len]<=122)or(word[i+len]>=65andword[i+len]<=90)or(word[i+len]>=48andword[i+len]<=57)orword[i+len]=='_'){continue;}stringone=word.substr(0,i);stringtwo=replaceBy;stringthree=word.substr(i+varName.length(),word.length()-(i+varName.length()));word=one+two+three;i=-1;}}oFileHere<<word<<endl;}iFile.close();oFileHere.close();iFile.open("sudo.c");oFileHere.open(fileName);while(getline(iFile,word)){oFileHere<<word<<endl;}iFile.close();oFileHere.close();}voidVariable_Name_Search(){while(true){stringnameM,nameV;boolflag=false;cout<<"EnterfirstmethodNametoidentifyit'sscope(typeGlobalforglobalscope):";cin>>nameM;cout<<"Entervariablename:";cin>>nameV;for(finalMapIT=methodsAndTheirVariables.begin();finalMapIT!=methodsAndTheirVariables.end();finalMapIT++){if(nameM==finalMapIT->first){for(intk=0;k<(finalMapIT->second).size();k++){if((finalMapIT->second)[k]==nameV){flag=true;}}}}if(flag==false){cout<<"Methodandvariablenamedoesn'texit,tryagain\n";continue;}cout<<"Enteranewnametoreplaceyourvariablename:";stringreplaceBy;while(true){cin>>replaceBy;flag=true;if(!(replaceBy[0]=='_'or(replaceBy[0]>='a'andreplaceBy[0]<='z')or(replaceBy[0]>='A'andreplaceBy[0]<='Z'))){cout<<"Youenteredawrongvariablename.\n";cout<<"Enteravalidnametoreplaceyourvariablename:";continue;}for(inti=0;i<replaceBy.length();i++){if((replaceBy[i]=='_'or(replaceBy[i]>='a'andreplaceBy[i]<='z')or(replaceBy[i]>='A'andreplaceBy[i]<='Z'))){continue;}elseif(replaceBy[i]>=48andreplaceBy[i]<=57){continue;}else{cout<<"Youenteredawrongvariablename.\n";cout<<"Enteravalidnametoreplaceyourvariablename:";flag=false;break;}}if(flag==false)continue;boolk=false;for(finalMapIT=methodsAndTheirVariables.begin();finalMapIT!=methodsAndTheirVariables.end();finalMapIT++){if(finalMapIT->first==nameM){boolkk=false;for(inty=0;y<(finalMapIT->second).size();y++){if(replaceBy==(finalMapIT->second)[y]){cout<<"Thisvariablenameisalreadyexistinthisscope\n";cout<<"Trywithanother\n";kk=true;break;}}if(kk)break;k=false;break;}}//if(kk)continue;if(k)continue;if(Check_A_Valid_Name_Request(replaceBy,methods_list)){cout<<"Thisnamedmethodaleadyexist,trywithanother\n";continue;}if(Check_A_Valid_Name_Request(replaceBy,dataType_list)){cout<<"Thisnameddatatypealeadyexist,trywithanother\n";continue;}for(inti=0;i<32;i++){if(keywords_list[i]==replaceBy){cout<<"Thisnamedkeywordaleadyexist,trywithanother\n";flag=false;break;}}if(flag==false)continue;break;}cout<<"variablenameaccepted\n";Change_Variable_Name(nameM,nameV,replaceBy);break;}}voidMethod_Name_Search(){while(true){stringname;boolflag=false;cout<<"Enteryourmethodname:";cin>>name;if(name=="main"){cout<<"Youcan'tchangemainmethodename,tryanothermethodetochange\n";continue;}flag=Check_A_Valid_Name_Request(name,methods_list);if(!flag){cout<<"Yourenteredmethodisnotexist.\n";continue;}flag=checkVariableInRelationshipTree(name);if(flag){cout<<"Thisisalreadyavariablename\n,Trywithanother\n";continue;}cout<<"Enteranewnametoreplaceyourmethodname:";stringreplaceBy;while(true){cin>>replaceBy;flag=true;if(!(replaceBy[0]=='_'or(replaceBy[0]>='a'andreplaceBy[0]<='z')or(replaceBy[0]>='A'andreplaceBy[0]<='Z'))){cout<<"Youenteredawrongmethodname.\n";cout<<"Enteravalidnametoreplaceyourmethodname:";continue;}for(inti=0;i<replaceBy.length();i++){if((replaceBy[i]=='_'or(replaceBy[i]>='a'andreplaceBy[i]<='z')or(replaceBy[i]>='A'andreplaceBy[i]<='Z'))){continue;}elseif(replaceBy[i]>=48andreplaceBy[i]<=57){continue;}else{cout<<"Youenteredawrongmethods_listname.\n";cout<<"Enteravalidnametoreplaceyourmethodsname:";flag=false;break;}}if(flag==false)continue;if(Check_A_Valid_Name_Request(replaceBy,methods_list)){cout<<"Thisnamedmethodaleadyexist,trywithanother\n";continue;}if(Check_A_Valid_Name_Request(replaceBy,dataType_list)){cout<<"Thisnameddatatypealeadyexist,trywithanother\n";continue;}if(checkVariableInRelationshipTree(replaceBy)){cout<<"Thisvariablenameisalreadyexist\n,Trywithanother:";continue;}for(inti=0;i<32;i++){if(keywords_list[i]==replaceBy){cout<<"Thisnamedkeywordaleadyexist,trywithanother\n";flag=false;break;}}if(flag==false)continue;break;}cout<<"methodnameaccepted.\n";change_method_name(name,replaceBy);break;}}voidclearEverything(){variables_list.clear();methods_list.clear();dataType_list.clear();methodsAndTheirVariables.clear();variablesHolder.clear();methodsHolder.clear();reverseMethods.clear();methodAndLine.clear();variableAndLine.clear();}voidTaking_User_Input_For_Changing_A_Name(){Show_Methods_And_Their_Children_Variables();cout<<"Enter1tochangeVariablename\nor2tochangeMethodname\n";intchoice;cin>>choice;if(choice==1){Variable_Name_Search();}elseif(choice==2){Method_Name_Search();}elsereturn;}intmain(intargc,char*argv[]){fileName=argv[1];iFile.open(fileName);if(!iFile.is_open()){oFile<<"cFileisnotexist!!\n";return0;}iFile.close();inttotal_methods,total_variebles,total_keywords;inttotal_lines,total_chars,total_words,total_loops;total_words=0;total_chars=0;total_lines=0;total_variebles=0;total_loops=0;total_methods=0;total_keywords=0;line_Number_And_Char_Count(total_lines,total_chars);Words_Keys_And_Loop_Count(total_words,total_keywords,total_loops);Methods_VAriebles_Count(total_variebles,total_methods);Clear_Method_and_Variables_Name();printing_line_char_word_keyword(total_lines,total_chars,total_words,total_keywords);printing_loop(total_loops);Make_Relationship_Variable_and_Method();for(inti=0;i<dataType_list.size();i++){cout<<dataType_list[i]<<endl;}Taking_User_Input_For_Changing_A_Name();return0;}